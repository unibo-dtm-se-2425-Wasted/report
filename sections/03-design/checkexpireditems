@startuml
title Activity Diagram: Scheduled Expiry Check

start

:Scheduled Task Triggered\n(e.g., Daily Cron Job);
:Application Service:\nCheckExpiredItemsCommand;
:Call FoodItemRepository.findAllActiveItems();
:Retrieve Active Food Items from SQLite DB;

repeat
  :For Each FoodItem;
  if (Is expirationDate < Today?) then (Yes)
    :FoodItem.markAsExpired();
    :FoodItemRepository.save(foodItem);
    :Update FoodItem in DB to 'Expired';
    :Publish FoodItemExpired Event;
    :NotificationService handles Event;
    :Prepare & Send Alert\n(e.g., Email, Push Notification);
  else (No)
    :Skip Item;
  endif
repeat while (More Items?) is (Yes)

:Commit Transaction;
stop

@enduml
